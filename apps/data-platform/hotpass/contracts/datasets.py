"""Dataset contract catalogue for Hotpass source and refined tables."""

from __future__ import annotations

from collections.abc import Mapping

from .types import DatasetContract, FieldContract

__all__ = ["DATASET_CONTRACTS", "DATASET_BY_NAME"]

DATASET_CONTRACTS: tuple[DatasetContract, ...] = (
    DatasetContract(
        name="contact_capture",
        title="Contact Database capture log",
        description="Schema for 10-10-25 Capture sheet in Contact Database.xlsx",
        primary_key=("School",),
        fields=(
            FieldContract(
                name="Unnamed: 0",
                field_type="string",
                description="Source worksheet row identifier",
                example="1",
                python_name="capture_row",
            ),
            FieldContract(
                name="School",
                field_type="string",
                required=True,
                description="School or organisation name captured during outreach",
                example="Blue Sky Flight Academy",
            ),
            FieldContract(
                name="Contact person (role)",
                field_type="string",
                description="Primary contact name with role context",
                example="Lerato Mokoena (Training Director)",
                python_name="contact_person",
            ),
            FieldContract(
                name="Phone",
                field_type="string",
                description="Primary phone number captured for the contact",
                example="+27 82 000 0000",
            ),
            FieldContract(
                name="Email",
                field_type="string",
                description="Email address captured for the contact",
                example="lerato@bluesky.ac.za",
            ),
            FieldContract(
                name="Addresses",
                field_type="string",
                description="Free-form address information captured from the sheet",
                example="12 Aviation Road, Midrand",
            ),
            FieldContract(
                name="Planes",
                field_type="string",
                description="Aircraft or fleet notes gathered during outreach",
                example="Cessna 172; Piper PA-28",
            ),
            FieldContract(
                name="Website",
                field_type="string",
                description="Organisation website or landing page",
                example="https://www.bluesky.ac.za",
            ),
            FieldContract(
                name="Description",
                field_type="string",
                description="Narrative notes captured by the outreach team",
                example="Focus on instrument training for commercial pilots",
            ),
            FieldContract(
                name="Type",
                field_type="string",
                description="Captured organisation classification from the sheet",
                example="Flight School",
                python_name="record_type",
            ),
        ),
        examples=(
            {
                "Unnamed: 0": "1",
                "School": "Blue Sky Flight Academy",
                "Contact person (role)": "Lerato Mokoena (Training Director)",
                "Phone": "+27 82 000 0000",
                "Email": "lerato@bluesky.ac.za",
                "Addresses": "12 Aviation Road, Midrand",
                "Planes": "Cessna 172; Piper PA-28",
                "Website": "https://www.bluesky.ac.za",
                "Description": "Focus on instrument training for commercial pilots",
                "Type": "Flight School",
            },
        ),
    ),
    DatasetContract(
        name="contact_company_addresses",
        title="Contact Database addresses",
        description="Schema for Company_Addresses sheet in Contact Database.xlsx",
        primary_key=("C_ID", "Type"),
        fields=(
            FieldContract(
                name="C_ID",
                field_type="number",
                required=True,
                description="Numeric company identifier from the Contact Database",
                example=101,
            ),
            FieldContract(
                name="Company",
                field_type="string",
                required=True,
                description="Registered company name",
                example="Northwind Aviation",
            ),
            FieldContract(
                name="Type",
                field_type="string",
                description="Address type classification (for example Head Office)",
                example="Head Office",
                python_name="address_type",
            ),
            FieldContract(
                name="Airport",
                field_type="string",
                description="Associated airport or facility if present",
                example="FALA",
            ),
            FieldContract(
                name="Unnamed: 4",
                field_type="string",
                description="Spare column for auxiliary notes in the source workbook",
                example="Hangar B3",
                python_name="address_notes",
            ),
        ),
        examples=(
            {
                "C_ID": 101,
                "Company": "Northwind Aviation",
                "Type": "Head Office",
                "Airport": "FALA",
                "Unnamed: 4": "Hangar B3",
            },
        ),
    ),
    DatasetContract(
        name="contact_company_cat",
        title="Contact Database company catalogue",
        description="Schema for Company_Cat sheet in Contact Database.xlsx",
        primary_key=("C_ID",),
        fields=(
            FieldContract(
                name="C_ID",
                field_type="number",
                required=True,
                description="Numeric company identifier",
                example=101,
            ),
            FieldContract(
                name="Company",
                field_type="string",
                required=True,
                description="Registered company name",
                example="Northwind Aviation",
            ),
            FieldContract(
                name="QuickNooks_Name",
                field_type="string",
                description="Imported QuickBooks account name when available",
                example="Northwind Aviation (Pty) Ltd",
                python_name="quickbooks_name",
            ),
            FieldContract(
                name="Last_Order_Date",
                field_type="string",
                description="Most recent recorded order date",
                example="2025-09-30",
                python_name="last_order_date",
            ),
            FieldContract(
                name="Category",
                field_type="string",
                description="Operational category tag assigned by outreach",
                example="Aviation Training",
            ),
            FieldContract(
                name="Strat",
                field_type="string",
                description="Strategic segment classification",
                example="Core",
            ),
            FieldContract(
                name="Priority",
                field_type="string",
                description="Prioritisation tier",
                example="High",
            ),
            FieldContract(
                name="Status",
                field_type="string",
                description="Engagement status in the Contact Database",
                example="Active",
            ),
            FieldContract(
                name="LoadDate",
                field_type="string",
                description="Initial load date for the record",
                example="2025-09-01",
                python_name="load_date",
            ),
            FieldContract(
                name="Checked",
                field_type="string",
                description="Quality assurance marker from source workbook",
                example="Yes",
            ),
            FieldContract(
                name="Website",
                field_type="string",
                description="Company website",
                example="https://northwind.example",
            ),
        ),
        examples=(
            {
                "C_ID": 101,
                "Company": "Northwind Aviation",
                "QuickNooks_Name": "Northwind Aviation (Pty) Ltd",
                "Last_Order_Date": "2025-09-30",
                "Category": "Aviation Training",
                "Strat": "Core",
                "Priority": "High",
                "Status": "Active",
                "LoadDate": "2025-09-01",
                "Checked": "Yes",
                "Website": "https://northwind.example",
            },
        ),
    ),
    DatasetContract(
        name="contact_company_contacts",
        title="Contact Database contacts",
        description="Schema for Company_Contacts sheet in Contact Database.xlsx",
        primary_key=("C_ID", "Email", "Cellnumber", "Landline"),
        fields=(
            FieldContract(
                name="C_ID",
                field_type="number",
                required=True,
                description="Numeric company identifier",
                example=101,
            ),
            FieldContract(
                name="Company",
                field_type="string",
                required=True,
                description="Company name for the contact",
                example="Northwind Aviation",
            ),
            FieldContract(
                name="Status",
                field_type="string",
                description="Engagement status for the contact",
                example="Primary",
            ),
            FieldContract(
                name="FirstName",
                field_type="string",
                description="Contact given name",
                example="Naledi",
                python_name="first_name",
            ),
            FieldContract(
                name="Surname",
                field_type="string",
                description="Contact surname",
                example="Nkosi",
            ),
            FieldContract(
                name="Position",
                field_type="string",
                description="Role or job title",
                example="Operations Manager",
            ),
            FieldContract(
                name="Cellnumber",
                field_type="string",
                description="Mobile number",
                example="+27 82 100 2000",
            ),
            FieldContract(
                name="Email",
                field_type="string",
                description="Email address",
                example="naledi.nkosi@northwind.example",
            ),
            FieldContract(
                name="Landline",
                field_type="string",
                description="Landline number if supplied",
                example="011 555 0100",
            ),
        ),
        examples=(
            {
                "C_ID": 101,
                "Company": "Northwind Aviation",
                "Status": "Primary",
                "FirstName": "Naledi",
                "Surname": "Nkosi",
                "Position": "Operations Manager",
                "Cellnumber": "+27 82 100 2000",
                "Email": "naledi.nkosi@northwind.example",
                "Landline": "011 555 0100",
            },
        ),
    ),
    DatasetContract(
        name="reachout_contact_info",
        title="Reachout contact info sheet",
        description="Contract defining the Contact Info sheet in Reachout Database.xlsx",
        primary_key=("ID", "Email", "Phone"),
        fields=(
            FieldContract(
                name="ID",
                field_type="number",
                required=True,
                description="Reachout record identifier",
                example=501,
            ),
            FieldContract(
                name="Organisation Name",
                field_type="string",
                required=True,
                description="Organisation associated with the outreach record",
                example="Aerotech College",
                python_name="organisation_name",
            ),
            FieldContract(
                name="Reachout Date",
                field_type="string",
                description="Date the outreach took place",
                example="2025-08-15",
                python_name="reachout_date",
            ),
            FieldContract(
                name="Firstname",
                field_type="string",
                description="Contact given name",
                example="Imani",
                python_name="first_name",
            ),
            FieldContract(
                name="Surname",
                field_type="string",
                description="Contact surname",
                example="Dlamini",
            ),
            FieldContract(
                name="Position",
                field_type="string",
                description="Role captured during outreach",
                example="Head of Training",
            ),
            FieldContract(
                name="Phone",
                field_type="string",
                description="Primary phone number recorded",
                example="+27 83 400 5000",
            ),
            FieldContract(
                name="WhatsApp",
                field_type="string",
                description="WhatsApp number if supplied",
                example="+27 83 400 5000",
            ),
            FieldContract(
                name="Email",
                field_type="string",
                description="Email address recorded for the contact",
                example="imani.dlamini@aerotech.ac.za",
            ),
            FieldContract(
                name="Invalid",
                field_type="string",
                description="Flags invalid contact information",
                example="",
            ),
            FieldContract(
                name="Unnamed: 10",
                field_type="string",
                description="Auxiliary notes column",
                example="Prefers email follow-up",
                python_name="additional_notes",
            ),
        ),
        examples=(
            {
                "ID": 501,
                "Organisation Name": "Aerotech College",
                "Reachout Date": "2025-08-15",
                "Firstname": "Imani",
                "Surname": "Dlamini",
                "Position": "Head of Training",
                "Phone": "+27 83 400 5000",
                "WhatsApp": "+27 83 400 5000",
                "Email": "imani.dlamini@aerotech.ac.za",
                "Invalid": "",
                "Unnamed: 10": "Prefers email follow-up",
            },
        ),
    ),
    DatasetContract(
        name="reachout_organisation",
        title="Reachout organisation sheet",
        description="Contract defining the Organisation sheet in Reachout Database.xlsx",
        primary_key=("ID",),
        fields=(
            FieldContract(
                name="Organisation Name",
                field_type="string",
                required=True,
                description="Organisation name tracked in Reachout",
                example="Aerotech College",
                python_name="organisation_name",
            ),
            FieldContract(
                name="ID",
                field_type="number",
                required=True,
                description="Reachout record identifier",
                example=501,
            ),
            FieldContract(
                name="Reachout Date",
                field_type="string",
                description="Date of most recent outreach",
                example="2025-08-15",
                python_name="reachout_date",
            ),
            FieldContract(
                name="Recent_Touch_Ind",
                field_type="string",
                description="Indicator flag for recent engagement",
                example="Y",
                python_name="recent_touch_indicator",
            ),
            FieldContract(
                name="Area",
                field_type="string",
                description="Geographic area",
                example="Gauteng",
            ),
            FieldContract(
                name="Distance",
                field_type="string",
                description="Distance notes from the Reachout workbook",
                example="35 km from Johannesburg",
            ),
            FieldContract(
                name="Type",
                field_type="string",
                description="Organisation type",
                example="Flight School",
                python_name="organisation_type",
            ),
            FieldContract(
                name="Website",
                field_type="string",
                description="Organisation website",
                example="https://aerotech.ac.za",
            ),
            FieldContract(
                name="Address",
                field_type="string",
                description="Physical address",
                example="45 Sky Lane, Germiston",
            ),
            FieldContract(
                name="Planes",
                field_type="string",
                description="Aircraft or fleet summary",
                example="Diamond DA40; Tecnam P2006",
            ),
            FieldContract(
                name="Description Type",
                field_type="string",
                description="Description category",
                example="Aviation Training",
                python_name="description_type",
            ),
            FieldContract(
                name="Notes",
                field_type="string",
                description="General notes",
                example="Interested in data-sharing pilot",
            ),
            FieldContract(
                name="Open Questions",
                field_type="string",
                description="Outstanding questions logged by outreach",
                example="Need confirmation on simulator availability",
                python_name="open_questions",
            ),
        ),
        examples=(
            {
                "Organisation Name": "Aerotech College",
                "ID": 501,
                "Reachout Date": "2025-08-15",
                "Recent_Touch_Ind": "Y",
                "Area": "Gauteng",
                "Distance": "35 km from Johannesburg",
                "Type": "Flight School",
                "Website": "https://aerotech.ac.za",
                "Address": "45 Sky Lane, Germiston",
                "Planes": "Diamond DA40; Tecnam P2006",
                "Description Type": "Aviation Training",
                "Notes": "Interested in data-sharing pilot",
                "Open Questions": "Need confirmation on simulator availability",
            },
        ),
    ),
    DatasetContract(
        name="sacaa_cleaned",
        title="SACAA cleaned sheet",
        description="Schema for Cleaned sheet in SACAA Flight Schools workbook",
        primary_key=("Name of Organisation",),
        fields=(
            FieldContract(
                name="Name of Organisation",
                field_type="string",
                required=True,
                description="Organisation name listed by SACAA",
                example="SkyReach Training Centre",
                python_name="organisation_name",
            ),
            FieldContract(
                name="Province",
                field_type="string",
                description="Province recorded by SACAA",
                example="KwaZulu-Natal",
            ),
            FieldContract(
                name="Status",
                field_type="string",
                description="Approval status",
                example="Approved",
            ),
            FieldContract(
                name="Website URL",
                field_type="string",
                description="Website URL captured in the SACAA sheet",
                example="https://skyreach.example",
                python_name="website_url",
            ),
            FieldContract(
                name="Contact Person",
                field_type="string",
                description="Named contact person",
                example="Sipho Zulu",
                python_name="contact_person",
            ),
            FieldContract(
                name="Contact Number",
                field_type="string",
                description="Primary phone number",
                example="+27 31 200 3000",
                python_name="contact_number",
            ),
            FieldContract(
                name="Contact Email Address",
                field_type="string",
                description="Primary email address",
                example="info@skyreach.example",
                python_name="contact_email",
            ),
        ),
        examples=(
            {
                "Name of Organisation": "SkyReach Training Centre",
                "Province": "KwaZulu-Natal",
                "Status": "Approved",
                "Website URL": "https://skyreach.example",
                "Contact Person": "Sipho Zulu",
                "Contact Number": "+27 31 200 3000",
                "Contact Email Address": "info@skyreach.example",
            },
        ),
    ),
    DatasetContract(
        name="ssot",
        title="Hotpass single source of truth",
        description="Schema for the refined Hotpass dataset exported via the pipeline",
        primary_key=("organization_slug",),
        fields=(
            FieldContract(
                name="organization_name",
                field_type="string",
                required=True,
                description="Canonical organisation name after refinement",
                example="Northwind Aviation",
            ),
            FieldContract(
                name="organization_slug",
                field_type="string",
                required=True,
                description="Slugified identifier for downstream systems",
                example="northwind-aviation",
            ),
            FieldContract(
                name="province",
                field_type="string",
                description="Province derived from input datasets",
                example="Gauteng",
            ),
            FieldContract(
                name="country",
                field_type="string",
                description="Country derived from input datasets",
                example="South Africa",
            ),
            FieldContract(
                name="area",
                field_type="string",
                description="Local area or region",
                example="Johannesburg",
            ),
            FieldContract(
                name="address_primary",
                field_type="string",
                description="Primary address for the organisation",
                example="45 Sky Lane, Germiston",
            ),
            FieldContract(
                name="organization_category",
                field_type="string",
                description="High-level category assigned during refinement",
                example="Aviation Training",
            ),
            FieldContract(
                name="organization_type",
                field_type="string",
                description="Detailed organisation type",
                example="Flight School",
            ),
            FieldContract(
                name="status",
                field_type="string",
                description="Lifecycle status within the refined dataset",
                example="Active",
            ),
            FieldContract(
                name="website",
                field_type="string",
                description="Primary website",
                example="https://northwind.example",
            ),
            FieldContract(
                name="planes",
                field_type="string",
                description="Fleet summary",
                example="Cessna 172; Piper PA-28",
            ),
            FieldContract(
                name="description",
                field_type="string",
                description="Narrative description aggregated across sources",
                example="Instrument-focused commercial pilot academy",
            ),
            FieldContract(
                name="notes",
                field_type="string",
                description="Internal notes retained after refinement",
                example="High engagement potential for Q1 intake",
            ),
            FieldContract(
                name="source_datasets",
                field_type="string",
                required=True,
                description="Comma-delimited list of contributing datasets",
                example="contact_capture, reachout_organisation",
            ),
            FieldContract(
                name="source_record_ids",
                field_type="string",
                required=True,
                description="Identifiers for contributing source records",
                example="capture:1|reachout:501",
            ),
            FieldContract(
                name="contact_primary_name",
                field_type="string",
                description="Primary contact name after consolidation",
                example="Naledi Nkosi",
            ),
            FieldContract(
                name="contact_primary_role",
                field_type="string",
                description="Primary contact role",
                example="Operations Manager",
            ),
            FieldContract(
                name="contact_primary_email",
                field_type="string",
                description="Primary contact email",
                example="naledi.nkosi@northwind.example",
            ),
            FieldContract(
                name="contact_primary_phone",
                field_type="string",
                description="Primary contact phone number",
                example="+27 82 100 2000",
            ),
            FieldContract(
                name="contact_secondary_emails",
                field_type="string",
                description="Secondary email addresses aggregated across inputs",
                example="info@northwind.example; support@northwind.example",
            ),
            FieldContract(
                name="contact_secondary_phones",
                field_type="string",
                description="Secondary phone numbers aggregated across inputs",
                example="011 555 0100",
            ),
            FieldContract(
                name="data_quality_score",
                field_type="number",
                description="Composite quality score generated by the pipeline",
                example=0.92,
            ),
            FieldContract(
                name="data_quality_flags",
                field_type="string",
                description="Delimited quality flags from validation",
                example="email_verified;has_recent_touch",
            ),
            FieldContract(
                name="selection_provenance",
                field_type="string",
                description="Details on how the record was selected or prioritised",
                example="reachout_follow_up",
            ),
            FieldContract(
                name="last_interaction_date",
                field_type="string",
                description="Last known interaction date",
                example="2025-09-20",
            ),
            FieldContract(
                name="priority",
                field_type="string",
                description="Priority ranking used by downstream teams",
                example="High",
            ),
            FieldContract(
                name="privacy_basis",
                field_type="string",
                description="Documented privacy basis for retaining the data",
                example="Legitimate interest",
            ),
        ),
        examples=(
            {
                "organization_name": "Northwind Aviation",
                "organization_slug": "northwind-aviation",
                "province": "Gauteng",
                "country": "South Africa",
                "area": "Johannesburg",
                "address_primary": "45 Sky Lane, Germiston",
                "organization_category": "Aviation Training",
                "organization_type": "Flight School",
                "status": "Active",
                "website": "https://northwind.example",
                "planes": "Cessna 172; Piper PA-28",
                "description": "Instrument-focused commercial pilot academy",
                "notes": "High engagement potential for Q1 intake",
                "source_datasets": "contact_capture, reachout_organisation",
                "source_record_ids": "capture:1|reachout:501",
                "contact_primary_name": "Naledi Nkosi",
                "contact_primary_role": "Operations Manager",
                "contact_primary_email": "naledi.nkosi@northwind.example",
                "contact_primary_phone": "+27 82 100 2000",
                "contact_secondary_emails": "info@northwind.example; support@northwind.example",
                "contact_secondary_phones": "011 555 0100",
                "data_quality_score": 0.92,
                "data_quality_flags": "email_verified;has_recent_touch",
                "selection_provenance": "reachout_follow_up",
                "last_interaction_date": "2025-09-20",
                "priority": "High",
                "privacy_basis": "Legitimate interest",
            },
        ),
    ),
)

DATASET_BY_NAME: Mapping[str, DatasetContract] = {
    contract.name: contract for contract in DATASET_CONTRACTS
}
